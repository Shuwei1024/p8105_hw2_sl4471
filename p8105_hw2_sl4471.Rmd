---
title: "p8105 homework2"
author: "Shuwei Liu sl4471"
date: 2018-10-03
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

# Problem 1

## 1.1 Import data

```{r import data of P1}
subway_df = 
  read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  janitor::clean_names() %>% 
  select(line, station_name, station_latitude, station_longitude, starts_with("route"), entry,
         vending, entrance_type, starts_with("ada")) %>% 
  mutate(entry = recode(entry, `YES` = TRUE, `NO` = FALSE))
```

## 1.2 Describe the data

```{r variables and dim}
variable.names(subway_df)
dim(subway_df)
```

This 1868 rows*20 columns data frame contains 20 variables, including "line", "station name", "station latitidu", "station longitude", "route1"-"route11", "entry", "vending", "entrance type", "ada" and "ada notes". After reading files, I use "janitor::clean_names()" to clean up variable names and covert them to lower snake case. And then, applying _select_ function to choose the column I want. Finally, _mutate_ function is used to convert the entry variable to a logical one. However, this data frame is not tidy yet. The different route numbers make it difficult to read.


```{r numbers and proportion}
count(distinct(subway_df, line, station_name))

ada_data = filter(subway_df, ada == TRUE)
count(distinct(ada_data, line, station_name))

without_vending = filter(subway_df, vending == "NO")
sum(without_vending$entry == TRUE)/length(without_vending$entry)
```

As above, there are 465 distinct stations, and 84 of them are ADA compliant. About 37.7% of station entrances / exits do not have vending allow entrance.

## 1.3 Reformat the data
```{r tidy data}
subway_tidy = 
  gather(subway_df, key = "route_number", value = "route_name", route1:route11)

A_line = filter(subway_tidy, route_name == "A") %>% 
  distinct(line, station_name, ada)
nrow(A_line)
count(A_line, ada == "TRUE")
```

Obviously, there are 60 stations that serve A line and 17 of them are ADA compliant.

